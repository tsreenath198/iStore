<div class="row">
  <div class="col-md-4">
    <div class="row">
      <div class="col-md-4 p-3">
        <h4>
          Choose Days:
        </h4>
      </div>
      <div class="col-md-8 p-3">
        <select
          class="form-control"
          name="pm"
          [(ngModel)]="selectedDay"
          #pm="ngModel"
          (change)="getTotalData()"
        >
          <option *ngFor="let cl of chooseDays">{{ cl }} </option>
        </select>
      </div>
    </div>
    <div class="row" *ngIf="totalTable.length > 0">
      <div class="col-md-4 p-3">
        <h5>Grand Total:</h5>
      </div>
      <div class="col-md-8 p-3">
        <h5>{{ grandTotal }}</h5>
      </div>
    </div>
  </div>
  <div class="col-md-5">
    <div class="accordion" *ngIf="totalTable.length > 0" id="accordionExample">
      <div class="card" *ngFor="let temp of totalTable; let i = index">
        <div class="card-header card-hover" [attr.id]="'heading' + i">
          <div
            class="mb-0 clearfix"
            data-toggle="collapse"
            [attr.data-target]="'#collapse' + i"
            aria-expanded="false"
            [attr.aria-controls]="'#collapse' + i"
            (click)="filterData(temp.date)"
          >
            <span class="float-left">
              <strong>Date:</strong> {{ temp.date | date }}
            </span>
            <span class="float-right">
              <strong>Total:</strong> {{ temp.total }}
            </span>
          </div>
        </div>

        <div
          [attr.id]="'collapse' + i"
          class="collapse"
          [attr.aria-labelledby]="'heading' + i"
          data-parent="#accordionExample"
        >
          <div
            class="card-body table  table-responsive table-hover"
            style="padding: 0;"
          >
            <table style="width: 100%;table-layout: fixed;">
              <thead>
                <tr>
                  <td colspan="4">
                    <strong>Cash:</strong>{{ temp.cashTotal }}
                  </td>
                  <td><strong>Bank:</strong>{{ temp.bankTotal }}</td>
                </tr>
                <tr>
                  <th>Bill.no</th>
                  <th>Date</th>
                  <th>Total</th>
                  <th>Action</th>
                  <th></th>
                </tr>
              </thead>
              <tbody>
                <ng-container *ngFor="let order of cardTable">
                  <tr>
                    <td (click)="openPopup(order, billContent)">
                      {{ order.id }}
                    </td>
                    <td (click)="openPopup(order, billContent)">
                      {{ order.createdDate | date }}
                    </td>
                    <td (click)="openPopup(order, billContent)">
                      {{ order.total }}
                    </td>
                    <td>
                      <button
                        class="btn btn-sm "
                        type="submit"
                        (click)="edit(order)"
                      >
                        Edit
                        <i
                          class="fa  fa-edit"
                          style="font-size: 10px;"
                          aria-hidden="true"
                        ></i>
                      </button>
                    </td>
                    <td>
                      <button
                        class="btn btn-sm "
                        type="submit"
                        (click)="delete(order, temp.date)"
                      >
                        Delete
                        <i
                          class="fa  fa-trash"
                          style="font-size: 10px;"
                          aria-hidden="true"
                        ></i>
                      </button>
                    </td>
                  </tr>
                </ng-container>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
    <div class="pt-5 pl-5" *ngIf="totalTable.length == 0">
      <h3>
        No data available!
      </h3>
    </div>
  </div>
  <ng-template #billContent let-c="close" let-d="dismiss">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Bill</h4>
        <button
          type="button"
          class="close"
          aria-label="Close"
          (click)="d('Cross click')"
        >
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div id="print-section">
          <div style="text-align: center;">
            <small>NATURAL FRESH</small><br />
            <small>SRI YOGESHWARA ENTERPRISE</small><br />
            <small>TAX INVOICE #{{ popupContent.id }}</small
            ><br />
            <small>YELLAMMAGUTTA, NZB</small><br />
          </div>
          <hr />
          <div style="display: inline;">
            <div style="float: left;">
              <p *ngIf="popupContent?.contact?.name">
                <small>Name: {{ popupContent.contact.name }}</small>
              </p>
              <p>
                <small>Date:{{ popupContent.createdDate | date }}</small>
              </p>
            </div>
            <div style="float: right;">
              <p *ngIf="popupContent?.contact?.phone">
                <small>Phone: {{ popupContent.contact.phone }}</small>
              </p>
              <p>
                <small>
                  Time:{{ popupContent.createdDate | date: "h:mm:ss a" }}</small
                >
              </p>
            </div>
          </div>
          <div>
            <table class="table table-sm">
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Qty</th>
                  <th>Price</th>
                  <th>Disc(%)</th>
                  <th>Total</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of popupContent.items; let i = index">
                  <td>
                    {{ item.product.name }}({{ item.product.category.name }})
                  </td>
                  <td>
                    {{ item.quantity }}
                  </td>
                  <td>
                    {{ item.price }}
                  </td>
                  <td>
                    {{ item.discount }}
                  </td>
                  <td>
                    {{ item.total }}
                  </td>
                </tr>
                <tr *ngIf="popupContent.totalDiscount">
                  <td colspan="4">
                    <b>Assitional Discount</b>
                  </td>
                  <td>
                    <b>{{ popupContent.totalDiscount }}</b>
                  </td>
                </tr>
                <tr>
                  <td colspan="4">
                    <b>Total</b>
                  </td>
                  <td>
                    <b>{{ popupContent.total }}</b>
                  </td>
                </tr>
              </tbody>
            </table>
            <span *ngIf="popupContent.paymentMode">
              <hr />
              Payment Mode : {{ popupContent?.paymentMode }}</span
            >
          </div>
          <div style="text-align: center;">
            <hr />
            <small>THANK YOU! VISIT AGAIN</small>
            <hr />
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-secondary"
          printSectionId="print-section"
          [printStyle]="{
            div: { 'margin-left': '-5px', 'margin-right': '-5px' }
          }"
          ngxPrint
        >
          Print
        </button>
        <button
          type="button"
          class="btn btn-secondary"
          (click)="close('Close click')"
        >
          Close
        </button>
      </div>
    </div>
  </ng-template>
</div>
